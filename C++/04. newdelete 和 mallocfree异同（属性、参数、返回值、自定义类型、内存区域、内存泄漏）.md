# 04. new/delete 和 malloc/free异同（属性、参数、返回值、自定义类型、内存区域、内存泄漏）

相同点：使用目的---为了申请和释放动态内存

差异：

+ 属性：new/delete是关键字--- 是c/c++的标准库函数
+ 参数：new自动计算分配大小 --- malloc需要指定大小
+ 返回值：new是类型安全的，成功返回对象的指针，无需类型转换，失败时抛出异常--- malloc类型不安全，成功返回void *（void指针），需要通过强制转换，失败返回NULL
+ 效率：new/delete效率比malloc和free高
+ 自定义类型：new/delete会调用类型的构造函数和析构函数（先operator new；构造函数；返回指针；析构；operator delete释放） --- malloc/free是库函数，只能动态申请和释放，无法强制其做自定义类型的构造和析构工作
+ 内存区域：new操作符从自由存储区（free store）上为对象动态分配内存空间，而malloc函数从堆上动态分配内存。自由存储区是C++基于new操作符的一个抽象概念，凡是通过new操作符进行内存申请，该内存即为自由存储区。而堆是操作系统中的术语，是操作系统所维护的一块特殊内存，用于程序的内存动态分配，C语言使用malloc从堆上分配内存，使用free释放已分配的对应内存。自由存储区不等于堆，如上所述，布局new就可以不位于堆中。
+ 内存泄漏：内存泄漏对于new和malloc都能检测出来，而new可以指明是哪个文件的哪一行，malloc确不可以。